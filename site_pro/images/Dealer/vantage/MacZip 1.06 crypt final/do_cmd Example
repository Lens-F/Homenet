-- Enter here your Commandlineset CommandLine to "zip -rm archive *"try	tell application "MacZip crypt (FAT)"		activate		with timeout of 90000 seconds			-- uncomment the following command to suppress warning 			-- boxes for switches -m and -df 			do_cmd "NoWarningBoxes"			do_cmd CommandLine		end timeout		quit	end tellon error number ErrorNumber	beep 1	activate	-- unfortunately there is a overlap of the errorcodes	-- so we need to distinguish between zip and unzip	if CommandLine starts with "zip" then Â		ZipErrorHandler(CommandLine, ErrorNumber)	if CommandLine starts with "unzip" then Â		UnzipErrorHandler(CommandLine, ErrorNumber)end tryon ZipErrorHandler(ErrorMessage, ErrorNumber)	-- Error return values.  The values 0..4 and 12..18 follow the conventions	-- of PKZIP.   The values 4..10 are all assigned to "insufficient memory"	-- by PKZIP, so the codes 5..10 are used here for other purposes. 	try		set TempErrNum to ErrorNumber		if ErrorNumber = 80 then set TempErrNum to 19		item TempErrNum of {Â			" unknown ", Â			" unexpected end of zip file ", Â			" zip file structure error ", Â			" out of memory ", Â			" internal logic error ", Â			" entry too large to split ", Â			" invalid comment format ", Â			" zip test (-T) failed or out of memory ", Â			" user interrupt or termination ", Â			" error using a temp file ", Â			" read or seek error ", Â			" nothing to do ", Â			" missing or empty zip file ", Â			" error writing to a file ", Â			" couldn't open to write ", Â			" bad command line ", Â			" unknown ", Â			" could not open a specified file to read ", Â			" user hit [command] + [.] to terminate "}	on error		set result to "Unknown Error"	end try	display dialog Â		"Command failed: " & return & "[" & ErrorMessage & Â		"]" & return & "\"" & result & " \"" & return Â		& "Result Code: " & ErrorNumber buttons {"Ooops"} default button 1 Â		with icon stop	end ZipErrorHandleron UnzipErrorHandler(ErrorMessage, ErrorNumber)	try		set TempErrNum to ErrorNumber		if ErrorNumber = 50 then set TempErrNum to 12		if ErrorNumber = 51 then set TempErrNum to 13		if ErrorNumber = 80 then set TempErrNum to 14		if ErrorNumber = 81 then set TempErrNum to 15		if ErrorNumber = 82 then set TempErrNum to 16				item TempErrNum of {Â			" warning error ", Â			" error in zipfile ", Â			" severe error in zipfile ", Â			" insufficient memory (during initialization) ", Â			" insufficient memory (password failure) ", Â			" insufficient memory (file decompression) ", Â			" insufficient memory (memory decompression) ", Â			" insufficient memory (not yet used) ", Â			" zipfile not found ", Â			" bad or illegal parameters specified ", Â			" no files found ", Â			"  disk full ", Â			"  unexpected EOF ", Â			"  user hit [command] + [.] to terminate ", Â			"  no files found: all unsup. compr/encrypt. ", Â			"  no files found: all had bad password "}	on error		set result to "Unknown Error"	end try	display dialog Â		"Command failed: " & return & "[" & ErrorMessage & Â		"]" & return & "\"" & result & " \"" & return Â		& "Result Code: " & ErrorNumber buttons {"Ooops"} default button 1 Â		with icon stopend UnzipErrorHandler